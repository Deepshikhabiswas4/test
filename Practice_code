from pyspark.sql import SparkSession

spark = SparkSession.builder \
    .appName("Truncate Delta Table") \
    .getOrCreate()

# Delta table path
cbs_datalake_path = "your/datalake/path/cbs_delta_table"

# Remove all rows but keep the structure & Delta log
spark.sql(f"DELETE FROM delta.`{cbs_datalake_path}` WHERE true")

print("All data removed successfully, structure retained.")
