from pyspark.sql import SparkSession

spark = SparkSession.builder \
    .appName("Truncate CBS Delta Table") \
    .getOrCreate()

CBS_BALANCE_DATALAKE_PATH = "hdfs://10.177.103.199:8022/data-lake/Fincore/totalData/CBS_Data"

# Read the table
df = spark.read.format("delta").load(CBS_BALANCE_DATALAKE_PATH)

# Create empty dataframe with same schema
emptyDF = df.limit(0)

# Overwrite existing data but keep schema & delta log
emptyDF.write.format("delta") \
    .mode("overwrite") \
    .option("overwriteSchema", "true") \
    .save(CBS_BALANCE_DATALAKE_PATH)

print("All data cleared successfully â€” structure kept & delta path unchanged.")
